var Trait=(function(){var u=(function(){try{var K={};Object.defineProperty(K,"x",{get:function(){return 0}});return K.x===0}catch(J){return false}})();function t(){try{if(Object.getOwnPropertyDescriptor){var K={x:0};return !!Object.getOwnPropertyDescriptor(K,"x")}}catch(J){}return false}function D(){try{if(Object.defineProperty){var K={};Object.defineProperty(K,"x",{value:0});return K.x===0}}catch(J){}return false}var F=Function.prototype.call;var i=Function.prototype.bind?function(J,K){return Function.prototype.bind.call(J,K)}:function(K,L){function J(M){return K.apply(L,arguments)}return J};var q=i(F,Object.prototype.hasOwnProperty);var x=i(F,Array.prototype.slice);var B=Array.prototype.forEach?i(F,Array.prototype.forEach):function(K,L){for(var M=0,J=K.length;M<J;M++){L(K[M])}};var f=Object.freeze||function(J){return J};var e=Object.getPrototypeOf||function(J){return Object.prototype};var j=Object.getOwnPropertyNames||function(L){var J=[];for(var K in L){if(q(L,K)){J.push(K)}}return J};var s=t()?Object.getOwnPropertyDescriptor:function(K,J){return{value:K[J],enumerable:true,writable:true,configurable:true}};var k=D()?Object.defineProperty:function(L,K,J){L[K]=J.value};var E=Object.defineProperties||function(K,L){for(var J in L){if(q(L,J)){k(K,J,L[J])}}};var I=Object.create||function(K,M){var J;function L(){}L.prototype=K||Object.prototype;J=new L();if(M){E(J,M)}return J};var G=Object.getOwnProperties||function(K){var J={};B(j(K),function(L){J[L]=s(K,L)});return J};function b(K){var J=function(L){throw new Error("Conflicting property: "+K)};f(J.prototype);return f(J)}function m(J){return f({value:undefined,enumerable:false,required:true})}function g(J){var K=b(J);if(u){return f({get:K,set:K,enumerable:false,conflict:true})}else{return f({value:K,enumerable:false,conflict:true})}}function d(J,K){if(J===K){return J!==0||1/J===1/K}else{return J!==J&&K!==K}}function w(K,J){if(K.conflict&&J.conflict){return true}else{return(K.get===J.get&&K.set===J.set&&d(K.value,J.value)&&K.enumerable===J.enumerable&&K.required===J.required&&K.conflict===J.conflict)}}function A(J,K){return f(i(J,K))}function h(J){var K={};B(J,function(L){K[L]=true});return f(K)}var o=f({toString:function(){return"<Trait.required>"}});function r(K){var J={};B(j(K),function(M){var L=s(K,M);if(L.value===o){L=m(M)}else{if(typeof L.value==="function"){L.method=true;if("prototype" in L.value){f(L.value.prototype)}}else{if(L.get&&L.get.prototype){f(L.get.prototype)}if(L.set&&L.set.prototype){f(L.set.prototype)}}}J[M]=L});return J}function c(L){var K=x(arguments,0);var J={};B(K,function(M){B(j(M),function(O){var N=M[O];if(q(J,O)&&!J[O].required){if(N.required){return}if(!w(J[O],N)){J[O]=g(O)}}else{J[O]=N}})});return f(J)}function a(M,K){var J=h(M);var L={};B(j(K),function(N){if(!q(J,N)||K[N].required){L[N]=K[N]}else{L[N]=m(N)}});return f(L)}function n(L){var K=x(arguments,0);var J={};B(K,function(M){B(j(M),function(O){var N=M[O];if(!q(J,O)||J[O].required){J[O]=N}})});return f(J)}function l(L,J){var K={};B(j(J),function(M){if(q(L,M)&&!J[M].required){var N=L[M];if(q(K,N)&&!K[N].required){K[N]=g(N)}else{K[N]=J[M]}if(!q(K,M)){K[M]=m(M)}}else{if(q(K,M)){if(!J[M].required){K[M]=g(M)}}else{K[M]=J[M]}}});return f(K)}function z(K,N){var J={};var L=[];for(var M in K){if(q(K,M)){if(K[M]){J[M]=K[M]}else{L.push(M)}}}return l(J,a(L,N))}function p(M,L){var J=I(M);var K={};B(j(L),function(O){var N=L[O];if(N.required){if(!(O in M)){throw new Error("Missing required property: "+O)}}else{if(N.conflict){throw new Error("Remaining conflicting property: "+O)}else{if("value" in N){if(N.method){K[O]={value:A(N.value,J),enumerable:N.enumerable,configurable:N.configurable,writable:N.writable}}else{K[O]=N}}else{K[O]={get:N.get?A(N.get,J):undefined,set:N.set?A(N.set,J):undefined,enumerable:N.enumerable,configurable:N.configurable}}}}});E(J,K);return f(J)}function H(J,K){return p(Object.prototype,r(J),K)}function C(N,M){var J=j(N);var O=j(M);var K;if(J.length!==O.length){return false}for(var L=0;L<J.length;L++){K=J[L];if(!M[K]||!w(N[K],M[K])){return false}}return true}if(!Object.create){Object.create=I}if(!Object.getOwnProperties){Object.getOwnProperties=G}function y(J){return r(J)}y.required=f(o);y.compose=f(c);y.resolve=f(z);y.override=f(n);y.create=f(p);y.eqv=f(C);y.object=f(H);return f(y)})();if(typeof exports!=="undefined"){exports.Trait=Trait}(function(){var a=this;var c;if(typeof exports!=="undefined"){c=exports}else{c=a.MC={}}c.version="0.0.1";var b=a.jQuery||a.Zepto||a.ender;c.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)}).toUpperCase()};c.TObservable=Trait({_callbacks:{},bind:function(f,h,e){var d=this._callbacks;var g=d[f]||(d[f]=[]);g.push([h,e]);return this},unbind:function(g,j){var f;if(!g){this._callbacks={}}else{if(f=this._callbacks){if(!j){f[g]=[]}else{var h=f[g];if(!h){return this}for(var e=0,d=h.length;e<d;e++){if(h[e]&&j===h[e][0]){h[e]=null;break}}}}}return this},trigger:function(f){var g,n,k,m,h;var j=2;if(!(n=this._callbacks)){return this}while(j--){k=j?f:"all";if(g=n[k]){for(var e=0,d=g.length;e<d;e++){if(!(m=g[e])){g.splice(e,1);e--;d--}else{h=j?Array.prototype.slice.call(arguments,1):arguments;m[0].apply(m[1]||this,h)}}}}return this}});c.makeUnique=function(){var d=c.guid();return Trait({id:d})};c.TMap=Trait({count:0,put:function(d,e){if(!this.key){this.key=e;this.count++}else{throw"key exists"}},get:function(d){if(this.key){return this.key}else{throw"no value for that key"}},remove:function(d){var e=this.key;this.key=null;delete this.key;this.count--;return e},getValue:function(d){for(obj in this){if(this[obj]==v){return obj}}},size:function(){return this.count}});c.makeListener=function(d){return Trait({_messenger:d,bind:function(f,g,e){return this._messenger.bind(f,g,e)},unbind:function(e,f){return this._messenger.unbind(e,f)}})},c.makeDispatcher=function(d){return Trait({_messenger:d,trigger:function(e){return this._messenger.trigger(e)}})};c.makeActor=function(d){return Trait.compose(c.makeUnique(),c.makeDispatcher(d))};c.makeMediator=function(d){return Trait.compose(c.makeActor(d),c.makeDispatcher(d))};c.makeController=function(d){return c.makeDispatcher(d)};c.makeContext=function(d){return Trait({_messenger:d,m:Object.create(Object.prototype,c.TMap),v:Object.create(Object.prototype,c.TMap),c:Object.create(Object.prototype,c.TMap),Model:function(f){var e=Object.create(Object.prototype,Trait.compose(c.makeActor(this._messenger),Trait(f)));return e},View:function(f){var e=Object.create(Object.prototype,Trait.compose(c.makeMediator(this._messenger),Trait(f)));return e},Controller:function(f){var e=Object.create(Object.prototype,Trait.compose(c.makeController(this._messenger),Trait(f)));return e},bind:function(e,f){return this._messenger.bind(e,f,this)},unbind:function(e,f){return this._messenger.unbind(e,f)},trigger:function(e){return this._messenger.trigger(e)}})};c.Context=function(e){if(!e){e=Trait({})}var f=Trait.create(Object.prototype,c.TObservable);var d=Trait.create(Object.prototype,Trait.compose(c.makeContext(f),e));return d}})();