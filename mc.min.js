var Trait=(function(){var u=(function(){try{var K={};Object.defineProperty(K,"x",{get:function(){return 0}});return K.x===0}catch(J){return false}})();function t(){try{if(Object.getOwnPropertyDescriptor){var K={x:0};return !!Object.getOwnPropertyDescriptor(K,"x")}}catch(J){}return false}function D(){try{if(Object.defineProperty){var K={};Object.defineProperty(K,"x",{value:0});return K.x===0}}catch(J){}return false}var F=Function.prototype.call;var i=Function.prototype.bind?function(J,K){return Function.prototype.bind.call(J,K)}:function(K,L){function J(M){return K.apply(L,arguments)}return J};var q=i(F,Object.prototype.hasOwnProperty);var x=i(F,Array.prototype.slice);var B=Array.prototype.forEach?i(F,Array.prototype.forEach):function(K,L){for(var M=0,J=K.length;M<J;M++){L(K[M])}};var f=Object.freeze||function(J){return J};var e=Object.getPrototypeOf||function(J){return Object.prototype};var j=Object.getOwnPropertyNames||function(L){var J=[];for(var K in L){if(q(L,K)){J.push(K)}}return J};var s=t()?Object.getOwnPropertyDescriptor:function(K,J){return{value:K[J],enumerable:true,writable:true,configurable:true}};var k=D()?Object.defineProperty:function(L,K,J){L[K]=J.value};var E=Object.defineProperties||function(K,L){for(var J in L){if(q(L,J)){k(K,J,L[J])}}};var I=Object.create||function(K,M){var J;function L(){}L.prototype=K||Object.prototype;J=new L();if(M){E(J,M)}return J};var G=Object.getOwnProperties||function(K){var J={};B(j(K),function(L){J[L]=s(K,L)});return J};function b(K){var J=function(L){throw new Error("Conflicting property: "+K)};f(J.prototype);return f(J)}function m(J){return f({value:undefined,enumerable:false,required:true})}function g(J){var K=b(J);if(u){return f({get:K,set:K,enumerable:false,conflict:true})}else{return f({value:K,enumerable:false,conflict:true})}}function d(J,K){if(J===K){return J!==0||1/J===1/K}else{return J!==J&&K!==K}}function w(K,J){if(K.conflict&&J.conflict){return true}else{return(K.get===J.get&&K.set===J.set&&d(K.value,J.value)&&K.enumerable===J.enumerable&&K.required===J.required&&K.conflict===J.conflict)}}function A(J,K){return f(i(J,K))}function h(J){var K={};B(J,function(L){K[L]=true});return f(K)}var o=f({toString:function(){return"<Trait.required>"}});function r(K){var J={};B(j(K),function(M){var L=s(K,M);if(L.value===o){L=m(M)}else{if(typeof L.value==="function"){L.method=true;if("prototype" in L.value){f(L.value.prototype)}}else{if(L.get&&L.get.prototype){f(L.get.prototype)}if(L.set&&L.set.prototype){f(L.set.prototype)}}}J[M]=L});return J}function c(L){var K=x(arguments,0);var J={};B(K,function(M){B(j(M),function(O){var N=M[O];if(q(J,O)&&!J[O].required){if(N.required){return}if(!w(J[O],N)){J[O]=g(O)}}else{J[O]=N}})});return f(J)}function a(M,K){var J=h(M);var L={};B(j(K),function(N){if(!q(J,N)||K[N].required){L[N]=K[N]}else{L[N]=m(N)}});return f(L)}function n(L){var K=x(arguments,0);var J={};B(K,function(M){B(j(M),function(O){var N=M[O];if(!q(J,O)||J[O].required){J[O]=N}})});return f(J)}function l(L,J){var K={};B(j(J),function(M){if(q(L,M)&&!J[M].required){var N=L[M];if(q(K,N)&&!K[N].required){K[N]=g(N)}else{K[N]=J[M]}if(!q(K,M)){K[M]=m(M)}}else{if(q(K,M)){if(!J[M].required){K[M]=g(M)}}else{K[M]=J[M]}}});return f(K)}function z(K,N){var J={};var L=[];for(var M in K){if(q(K,M)){if(K[M]){J[M]=K[M]}else{L.push(M)}}}return l(J,a(L,N))}function p(M,L){var J=I(M);var K={};B(j(L),function(O){var N=L[O];if(N.required){if(!(O in M)){throw new Error("Missing required property: "+O)}}else{if(N.conflict){throw new Error("Remaining conflicting property: "+O)}else{if("value" in N){if(N.method){K[O]={value:A(N.value,J),enumerable:N.enumerable,configurable:N.configurable,writable:N.writable}}else{K[O]=N}}else{K[O]={get:N.get?A(N.get,J):undefined,set:N.set?A(N.set,J):undefined,enumerable:N.enumerable,configurable:N.configurable}}}}});E(J,K);return f(J)}function H(J,K){return p(Object.prototype,r(J),K)}function C(N,M){var J=j(N);var O=j(M);var K;if(J.length!==O.length){return false}for(var L=0;L<J.length;L++){K=J[L];if(!M[K]||!w(N[K],M[K])){return false}}return true}if(!Object.create){Object.create=I}if(!Object.getOwnProperties){Object.getOwnProperties=G}function y(J){return r(J)}y.required=f(o);y.compose=f(c);y.resolve=f(z);y.override=f(n);y.create=f(p);y.eqv=f(C);y.object=f(H);return f(y)})();if(typeof exports!=="undefined"){exports.Trait=Trait}(function(){var b;if(typeof exports!=="undefined"){b=exports}else{b=this.MC={}}b.version="0.0.1";var a=this.jQuery||this.Zepto;b.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)}).toUpperCase()};b.makeUnique=function(){var c=b.guid();return Trait({id:c})};b.TMap=Trait({count:0,dictionary:{},put:function(c,d){if(!this.dictionary.key){this.dictionary.key=d;this.count++}else{throw"key exists"}},get:function(c){if(this.dictionary.key){return this.dictionary.key}else{throw"no value for that key"}},remove:function(c){var d=this.dictionary.key;this.dictionary.key=null;delete this.dictionary.key;this.count--;return d},getValue:function(c){for(obj in this.dictionary){if(this.dictionary[obj]==v){return obj}}},size:function(){return this.count},load:function(c){this.dictionary=c}});b.TObservable=Trait({_fns:{},bind:function(h,f,d){var c=this._fns;var g=c[h]||(c[h]=[]);g.push([f,d]);return this},unbind:function(j,g){var f;if(!j){this._fns={}}else{if(f=this._fns){if(!g){f[j]=[]}else{var h=f[j];if(!h){return this}for(var d=0,c=h.length;d<c;d++){if(h[d]&&g===h[d][0]){h[d]=null;break}}}}}return this},trigger:function(f,g){var j,o,h,n,k;var m=2;if(!(o=this._fns)){return this}while(m--){h=m?f:"all";if(j=o[h]){for(var d=0,c=j.length;d<c;d++){if(!(n=j[d])){j.splice(d,1);d--;c--}else{n[0].apply(n[1]||this,[g])}}}}return this}});b.makeBindable=function(c){return Trait({_messenger:c,bind:function(g,f,d){return this._messenger.bind(g,f,d)},unbind:function(f,d){return this._messenger.unbind(f,d)}})},b.makeTriggerable=function(c){return Trait({_messenger:c,trigger:function(e,d){return this._messenger.trigger(e,d)}})};b.TPersistable=Trait({RL:Trait.required(),data:Object.create(Object.prototype,b.TMap),save:Trait.required(),find:Trait.required(),destroy:Trait.required(),});b.makeLocalService=function(c){return Trait.compose(b.TPersistable,Trait({RL:c,retrieve:function(){var d=JSON.parse(localStorage.getItem(this.RL));this.data.load(d)},set:function(){localStorage.setItem(this.RL,JSON.stringify(this.data))},save:function(d){this.data[d.id]=d.toJSON();return this.set()},get:function(e){var d=JSON.parse(this.data[e]);return Trait.object(d)},destroy:function(){delete this.data[model.id];return this.set()}}))};b.makeActor=function(c){return Trait.compose(b.makeUnique(),b.makeTriggerable(c),Trait({initialize:function(){}}))};b.makeView=function(d,c){return Trait.compose(b.makeActor(d),b.makeBindable(d),Trait({el:Trait.required,eventSplitter:/^(\w+)\s*(.*)$/,delegateEvents:function(){var f,i,g,j,e,h;h=[];for(i in this.events){j=this[this.events[i]];if(typeof j!=="function"){throw"events must be bound to a function"}g=i.match(this.eventSplitter);f=g[1];e=g[2];h.push(this.el.bind(f,a.proxy(j,this)))}return h}}))};b.makeController=function(c){return b.makeTriggerable(c)};b.makeContext=function(d){var c=Trait.override(Trait({_messenger:d,m:Object.create(Object.prototype,b.TMap),Model:function(e){var f=Object.create(Object.prototype,Trait.override(e,b.makeActor(this._messenger)));f.initialize();return f},View:function(f){var e=Object.create(Object.prototype,Trait.compose(b.makeView(this._messenger),f));e.delegateEvents();e.initialize();return e},Controller:function(f){var e=Object.create(Object.prototype,f);return e},Service:function(){return true},bind:function(g,f){return this._messenger.bind(g,f,this)}}),b.makeActor(d),b.makeBindable(d));return c};b.Context=function(d){if(!d){d=Trait({})}var e=Trait.create(Object.prototype,b.TObservable);var c=Trait.create(Object.prototype,Trait.compose(b.makeContext(e),d));return c}})();